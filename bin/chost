#!/bin/bash

die() {
	echo -e >&2 "$*"
	exit 1
}

[[ $# -ne 0 ]] || die "Usage: $0 HOSTNAME"
[[ $EUID -eq 0 ]] || die "root privileges required"

new_hostname=$1
old_hostname=$(hostname)

hostnamectl set-hostname "$new_hostname"
sed -i -e 's/\(127[.]0[.]1[.]1\s\+\)'"$old_hostname"'/\1'"$new_hostname"'/g' /etc/hosts
